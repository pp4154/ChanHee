import javax.swing.*;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;
import java.awt.*;
import java.awt.geom.RoundRectangle2D;

public class RGBColorMixer extends JFrame {
    private JSlider redSlider;
    private JSlider greenSlider;
    private JSlider blueSlider;
    
    private JLabel redValueLabel;
    private JLabel greenValueLabel;
    private JLabel blueValueLabel;
    
    private JPanel colorPreviewPanel;
    private JLabel hexLabel;
    
    private int redValue = 127;
    private int greenValue = 127;
    private int blueValue = 127;
    
    // 모던한 컬러 팔레트
    private final Color BACKGROUND = new Color(248, 249, 250);
    private final Color CARD_BG = Color.WHITE;
    private final Color TEXT_PRIMARY = new Color(33, 37, 41);
    private final Color TEXT_SECONDARY = new Color(108, 117, 125);
    
    public RGBColorMixer() {
        setTitle("RGB Color Mixer");
        setSize(600, 700);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new BorderLayout(0, 0));
        getContentPane().setBackground(BACKGROUND);
        
        // 메인 컨테이너
        JPanel mainContainer = new JPanel();
        mainContainer.setLayout(new BoxLayout(mainContainer, BoxLayout.Y_AXIS));
        mainContainer.setBackground(BACKGROUND);
        mainContainer.setBorder(BorderFactory.createEmptyBorder(40, 40, 40, 40));
        
        // 헤더
        mainContainer.add(createHeader());
        mainContainer.add(Box.createVerticalStrut(30));
        
        // 색상 프리뷰 (위에 배치)
        mainContainer.add(createModernPreviewPanel());
        mainContainer.add(Box.createVerticalStrut(40));
        
        // 슬라이더 컨트롤
        mainContainer.add(createModernControlPanel());
        
        add(mainContainer, BorderLayout.CENTER);
        
        updateColor();
        setLocationRelativeTo(null);
        setVisible(true);
    }
    
    private JPanel createHeader() {
        JPanel header = new JPanel();
        header.setLayout(new BoxLayout(header, BoxLayout.Y_AXIS));
        header.setBackground(BACKGROUND);
        
        JLabel title = new JLabel("Color Mixer");
        title.setFont(new Font("Segoe UI", Font.PLAIN, 32));
        title.setForeground(TEXT_PRIMARY);
        title.setAlignmentX(Component.CENTER_ALIGNMENT);
        
        JLabel subtitle = new JLabel("Blend your perfect color");
        subtitle.setFont(new Font("Segoe UI", Font.PLAIN, 14));
        subtitle.setForeground(TEXT_SECONDARY);
        subtitle.setAlignmentX(Component.CENTER_ALIGNMENT);
        
        header.add(title);
        header.add(Box.createVerticalStrut(8));
        header.add(subtitle);
        
        return header;
    }
    
    private JPanel createModernPreviewPanel() {
        JPanel container = new JPanel(new BorderLayout());
        container.setBackground(BACKGROUND);
        container.setMaximumSize(new Dimension(520, 280));
        
        colorPreviewPanel = new JPanel(new GridBagLayout()) {
            @Override
            protected void paintComponent(Graphics g) {
                super.paintComponent(g);
                Graphics2D g2 = (Graphics2D) g;
                g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                
                g2.setColor(getBackground());
                g2.fill(new RoundRectangle2D.Float(0, 0, getWidth(), getHeight(), 20, 20));
            }
        };
        colorPreviewPanel.setPreferredSize(new Dimension(520, 280));
        colorPreviewPanel.setOpaque(false);
        
        // HEX 값 표시
        hexLabel = new JLabel("#7F7F7F");
        hexLabel.setFont(new Font("Segoe UI", Font.BOLD, 48));
        hexLabel.setForeground(Color.WHITE);
        
        colorPreviewPanel.add(hexLabel);
        container.add(colorPreviewPanel, BorderLayout.CENTER);
        
        return container;
    }
    
    private JPanel createModernControlPanel() {
        JPanel panel = new JPanel();
        panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));
        panel.setBackground(BACKGROUND);
        
        // Red 슬라이더
        panel.add(createModernSliderCard("Red", new Color(239, 68, 68), redValue));
        panel.add(Box.createVerticalStrut(16));
        
        // Green 슬라이더
        panel.add(createModernSliderCard("Green", new Color(34, 197, 94), greenValue));
        panel.add(Box.createVerticalStrut(16));
        
        // Blue 슬라이더
        panel.add(createModernSliderCard("Blue", new Color(59, 130, 246), blueValue));
        
        return panel;
    }
    
    private JPanel createModernSliderCard(String colorName, Color accentColor, int initialValue) {
        JPanel card = new JPanel() {
            @Override
            protected void paintComponent(Graphics g) {
                Graphics2D g2 = (Graphics2D) g;
                g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                
                g2.setColor(CARD_BG);
                g2.fill(new RoundRectangle2D.Float(0, 0, getWidth(), getHeight(), 16, 16));
                
                // 그림자 효과
                g2.setColor(new Color(0, 0, 0, 8));
                g2.fill(new RoundRectangle2D.Float(0, 2, getWidth(), getHeight(), 16, 16));
            }
        };
        card.setLayout(new BorderLayout(20, 0));
        card.setOpaque(false);
        card.setMaximumSize(new Dimension(520, 80));
        card.setPreferredSize(new Dimension(520, 80));
        card.setBorder(BorderFactory.createEmptyBorder(20, 24, 20, 24));
        
        // 왼쪽: 색상 이름과 점
        JPanel leftPanel = new JPanel(new FlowLayout(FlowLayout.LEFT, 0, 0));
        leftPanel.setOpaque(false);
        
        JPanel colorDot = new JPanel() {
            @Override
            protected void paintComponent(Graphics g) {
                Graphics2D g2 = (Graphics2D) g;
                g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                g2.setColor(accentColor);
                g2.fillOval(2, 2, 12, 12);
            }
        };
        colorDot.setPreferredSize(new Dimension(16, 16));
        colorDot.setOpaque(false);
        
        JLabel nameLabel = new JLabel("  " + colorName);
        nameLabel.setFont(new Font("Segoe UI", Font.PLAIN, 16));
        nameLabel.setForeground(TEXT_PRIMARY);
        
        leftPanel.add(colorDot);
        leftPanel.add(nameLabel);
        
        // 중앙: 슬라이더
        JSlider slider = new JSlider(JSlider.HORIZONTAL, 0, 255, initialValue);
        slider.setOpaque(false);
        slider.setFocusable(false);
        
        // 슬라이더 UI 커스터마이징
        slider.setUI(new javax.swing.plaf.basic.BasicSliderUI(slider) {
            @Override
            public void paintTrack(Graphics g) {
                Graphics2D g2 = (Graphics2D) g;
                g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                
                Rectangle trackBounds = trackRect;
                int trackHeight = 6;
                int trackY = trackBounds.y + (trackBounds.height - trackHeight) / 2;
                
                // 배경 트랙
                g2.setColor(new Color(229, 231, 235));
                g2.fillRoundRect(trackBounds.x, trackY, trackBounds.width, trackHeight, 3, 3);
                
                // 활성 트랙
                int fillWidth = (int) ((trackBounds.width * slider.getValue()) / (double) slider.getMaximum());
                g2.setColor(accentColor);
                g2.fillRoundRect(trackBounds.x, trackY, fillWidth, trackHeight, 3, 3);
            }
            
            @Override
            public void paintThumb(Graphics g) {
                Graphics2D g2 = (Graphics2D) g;
                g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                
                // 그림자
                g2.setColor(new Color(0, 0, 0, 20));
                g2.fillOval(thumbRect.x - 1, thumbRect.y + 2, 18, 18);
                
                // 썸
                g2.setColor(Color.WHITE);
                g2.fillOval(thumbRect.x, thumbRect.y, 16, 16);
                
                // 테두리
                g2.setColor(accentColor);
                g2.setStroke(new BasicStroke(2));
                g2.drawOval(thumbRect.x + 1, thumbRect.y + 1, 14, 14);
            }
        });
        
        // 오른쪽: 값 표시
        JLabel valueLabel = new JLabel(String.valueOf(initialValue));
        valueLabel.setFont(new Font("Segoe UI", Font.BOLD, 20));
        valueLabel.setForeground(TEXT_PRIMARY);
        valueLabel.setPreferredSize(new Dimension(50, 30));
        valueLabel.setHorizontalAlignment(SwingConstants.CENTER);
        
        // 슬라이더별 저장
        if (colorName.equals("Red")) {
            redSlider = slider;
            redValueLabel = valueLabel;
            slider.addChangeListener(new ChangeListener() {
                public void stateChanged(ChangeEvent e) {
                    updateColor();
                }
            });
        } else if (colorName.equals("Green")) {
            greenSlider = slider;
            greenValueLabel = valueLabel;
            slider.addChangeListener(new ChangeListener() {
                public void stateChanged(ChangeEvent e) {
                    updateColor();
                }
            });
        } else {
            blueSlider = slider;
            blueValueLabel = valueLabel;
            slider.addChangeListener(new ChangeListener() {
                public void stateChanged(ChangeEvent e) {
                    updateColor();
                }
            });
        }
        
        card.add(leftPanel, BorderLayout.WEST);
        card.add(slider, BorderLayout.CENTER);
        card.add(valueLabel, BorderLayout.EAST);
        
        return card;
    }
    
    private void updateColor() {
        redValue = redSlider.getValue();
        greenValue = greenSlider.getValue();
        blueValue = blueSlider.getValue();
        
        redValueLabel.setText(String.valueOf(redValue));
        greenValueLabel.setText(String.valueOf(greenValue));
        blueValueLabel.setText(String.valueOf(blueValue));
        
        Color newColor = new Color(redValue, greenValue, blueValue);
        colorPreviewPanel.setBackground(newColor);
        
        String hexColor = String.format("#%02X%02X%02X", redValue, greenValue, blueValue);
        hexLabel.setText(hexColor);
        
        // 텍스트 색상 자동 조절
        int brightness = (int) (redValue * 0.299 + greenValue * 0.587 + blueValue * 0.114);
        hexLabel.setForeground(brightness > 128 ? new Color(33, 37, 41) : Color.WHITE);
        
        colorPreviewPanel.repaint();
    }
    
    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception e) {
                    e.printStackTrace();
                }
                new RGBColorMixer();
            }
        });
    }
}
